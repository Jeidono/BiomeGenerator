<html>
  <head>
    <title>Simple Geometry Test</title>
  </head>

  <style>
  body {margin: 0;}
  canvas {width: 100%; height: 100%;}
  </style>

  <body>
	<link rel="shortcut icon" href="#">

   
    <style>
    			body {
    				font-family: Monospace;
    				background-color: #000;
    				color: #fff;
    				margin: 0px;
    				overflow: hidden;
    			}
    			#info {
    				position: absolute;
    				top: 10px;
    				width: 100%;
    				text-align: center;
    			}
    </style>

    <div id="info">
      <p>This is the first example using threeJS<br>
      left button to rotate the scene, scroll to zoom in/out</p>
    </div>

		<script type="importmap">
			{
				"imports": {
					"three": "./build/three.module.js"
				}
			}
		</script>
		
	<script type="module">

	import * as THREE from 'three';

    var scene = new THREE.Scene( );
    var renderer = new THREE.WebGLRenderer( );
    renderer.setSize(window.innerWidth,window.innerHeight);
    document.body.appendChild(renderer.domElement );
    var ratio = window.innerWidth/window.innerHeight;

    //create the perspective camera
    //for parameters see https://threejs.org/docs/#api/cameras/PerspectiveCamera
    var camera = new THREE.PerspectiveCamera(45,ratio,0.00001,1000);
    var Pos = new THREE.Vector3(0,0,0);
    camera.position.set(Pos.x,Pos.y,Pos.z);
    var Dir = new THREE.Vector3(0,0,1);
    camera.lookAt(Dir.x,Dir.y,Dir.z);

    var material_box = new THREE.MeshBasicMaterial();
    material_box.color=  new THREE.Color(1,0,0);
    material_box.wireframe=true;
    var geometry_box = new THREE.BoxGeometry(10,0.1,10,32,1,32);

    var BoxMesh = new THREE.Mesh(geometry_box,material_box);
    BoxMesh.position.y=-1;
    scene.add(BoxMesh);

    var moveForward=false;
    var moveLeft=false;
    var moveBackward=false;
    var moveRight=false;

    const clock = new THREE.Clock();

    var speed=2;
    var angle=0;
    var MyUpdateLoop = function ( )
    {
      var delta = clock.getDelta();
      if (moveLeft==true)
      {
        Pos.x -= Dir.x*speed * delta;
      }
      if (moveRight==true)
      {
        angle-=speed*delta;
        Dir.x=Math.sin(angle);
        Dir.z=Math.cos(angle);
        Dir.normalize();
      }
      if (moveForward==true)
      {
        Pos.x+=Dir.x*speed*delta;
        //Pos.y+=Dir.y*speed*delta;
        Pos.z+=Dir.z*speed*delta;
      }
      if (moveBackward==true)
      {
        Pos.x-=Dir.x*speed*delta;
        //Pos.y-=Dir.y*speed*delta;
        Pos.z-=Dir.z*speed*delta;
      }
      renderer.render(scene,camera);

      camera.position.set(Pos.x,Pos.y,Pos.z);
      camera.lookAt(Pos.x+Dir.x,Pos.y+Dir.y,Pos.z+Dir.z);
      camera.updateProjectionMatrix();
      requestAnimationFrame(MyUpdateLoop);
    };
    requestAnimationFrame(MyUpdateLoop);

    var MyResize = function ( )
    {
      var width = window.innerWidth;
      var height = window.innerHeight;
      renderer.setSize(width,height);
      camera.aspect = width/height;

      camera.updateProjectionMatrix();

      renderer.render(scene,camera);
    };
    var onKeyDown = function ( event ) {

      switch ( event.keyCode ) {

        case 38: // up
        case 87: // w
          moveForward = true;
          break;

        case 37: // left
        case 65: // a
          moveLeft = true;
          break;

        case 40: // down
        case 83: // s
          moveBackward = true;
          break;

        case 39: // right
        case 68: // d
          moveRight = true;
          break;
      }
    };
    var onKeyUp = function ( event ) {

      switch( event.keyCode ) {

        case 38: // up
        case 87: // w
          moveForward = false;
          break;

        case 37: // left
        case 65: // a
          moveLeft = false;
          break;

        case 40: // down
        case 83: // s
          moveBackward = false;
          break;

        case 39: // right
        case 68: // d
          moveRight = false;
          break;

      }
    };
    window.addEventListener( 'resize', MyResize);

    document.addEventListener( 'keydown', onKeyDown, false );
    document.addEventListener( 'keyup', onKeyUp, false );


    </script>
  </body>
</html>
